# The Intent-Engine Way: A Guide to Intent-Driven Collaboration

## ä»‹ç»ï¼šè¿™ä¸ä»…ä»…æ˜¯ä¸€ä¸ªä»»åŠ¡åˆ—è¡¨

æ¬¢è¿ä½¿ç”¨ Intent-Engineã€‚åœ¨å¼€å§‹ä½¿ç”¨ä¹‹å‰ï¼Œæœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ç†è§£ï¼šå®ƒä¸æ˜¯ä¸€ä¸ªä¼ ç»Ÿçš„"å¾…åŠäº‹é¡¹"åº”ç”¨ï¼Œè€Œæ˜¯ä¸€ä¸ªåä½œæ¨¡å¼çš„åŸºçŸ³ã€‚

å®ƒçš„æ ¸å¿ƒç›®æ ‡æ˜¯ä¸ºäººç±»ä¸ AI çš„åä½œï¼Œå»ºç«‹ä¸€ä¸ªå…±äº«çš„ã€å¯è¿½æº¯çš„**"æ„å›¾"**å±‚ã€‚äººç±»è´Ÿè´£è®¾å®šæˆ˜ç•¥ç›®æ ‡ï¼ˆThe Intentï¼‰ï¼ŒAI åˆ™å›´ç»•è¿™ä¸ªç›®æ ‡å±•å¼€æˆ˜æœ¯æ‰§è¡Œï¼ˆThe Executionï¼‰ï¼Œè€Œ Intent-Engine å°±æ˜¯è¿æ¥è¿™ä¸¤å±‚çš„æ ¸å¿ƒå¼•æ“ã€‚

æœ¬æŒ‡å—å°†é˜è¿°ä½¿ç”¨ Intent-Engine çš„æ ‡å‡†å·¥ä½œæµç¨‹ï¼Œè§£é‡Šä½•æ—¶ä½¿ç”¨ã€å¦‚ä½•ä½¿ç”¨ä»¥åŠä¸ºä½•è¿™æ ·ä½¿ç”¨ã€‚

---

## ç¬¬ 1 æ­¥ï¼šæ•è·æ„å›¾ (When & How to `task add`)

### æ—¶æœº (When)

å½“ä¸€ä¸ªæƒ³æ³•æˆ–éœ€æ±‚å˜å¾—"è¶³å¤Ÿå¤æ‚"æ—¶ï¼Œå°±åº”è¯¥å°†å…¶æ•è·ä¸ºä¸€ä¸ª Intent-Engine ä»»åŠ¡ã€‚è§¦å‘æ¡ä»¶åŒ…æ‹¬ï¼š

- **å¤šæ­¥éª¤ä»»åŠ¡**: å½“ä½ æˆ– AI é¢„è§åˆ°å®Œæˆè¿™ä¸ªéœ€æ±‚éœ€è¦å¤šä¸ªç‹¬ç«‹çš„æ“ä½œæ­¥éª¤
- **éœ€è¦ä¸Šä¸‹æ–‡**: å½“ä»»åŠ¡çš„æ‰§è¡Œéœ€è¦ä¾èµ–å¤§é‡çš„èƒŒæ™¯ä¿¡æ¯ã€è®¨è®ºå†å²æˆ–ç‰¹å®šçš„è§„æ ¼è¯´æ˜
- **é•¿å‘¨æœŸå·¥ä½œ**: å½“ä»»åŠ¡ä¸å¯èƒ½åœ¨ä¸€æ¬¡äº¤äº’æˆ–ä¸€ä¸ªä¼šè¯ä¸­å®Œæˆï¼Œéœ€è¦è¢«ä¸­æ–­å’Œæ¢å¤
- **åä½œèŠ‚ç‚¹**: å½“ä»»åŠ¡çš„å®Œæˆéœ€è¦äººç±»å’Œ AI ä¹‹é—´è¿›è¡Œå¤šè½®çš„é—®ç­”ã€åé¦ˆå’Œå¹²é¢„

ä¸€ä¸ªèªæ˜çš„ AI Agent åº”è¯¥è¢«è®­ç»ƒæˆèƒ½å¤Ÿè¯†åˆ«è¿™äº›ä¿¡å·ï¼Œå¹¶ä¸»åŠ¨å‘äººç±»æè®®ï¼š

> "è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªå¤æ‚çš„ä»»åŠ¡ï¼Œæˆ‘å»ºè®®åˆ›å»ºä¸€ä¸ª Intent-Engine ä»»åŠ¡æ¥è·Ÿè¸ªå®ƒï¼Œæ‚¨åŒæ„å—ï¼Ÿ"

### æ–¹æ³• (How)

ä½¿ç”¨ `intent-engine task add`ã€‚å…³é”®åœ¨äº `spec` çš„è´¨é‡ã€‚

```bash
# å°†è¯¦ç»†çš„ã€ç»“æ„åŒ–çš„éœ€æ±‚é€šè¿‡ç®¡é“ä¼ é€’ç»™ --spec-stdin
echo "# ç›®æ ‡: å®ç° OAuth2 ç™»å½•

## éœ€æ±‚:
- æ”¯æŒ Google å’Œ GitHub
- ä¿ç•™å¯†ç ç™»å½•ä½œä¸ºåå¤‡æ–¹æ¡ˆ
- Token æœ‰æ•ˆæœŸ 7 å¤©ï¼Œæ”¯æŒåˆ·æ–°

## æŠ€æœ¯çº¦æŸ:
- ä½¿ç”¨ OAuth2 PKCE æµç¨‹
- å‰åç«¯åˆ†ç¦»æ¶æ„" | intent-engine task add --name "å®ç° OAuth2 ç™»å½•" --spec-stdin
```

### åŸå›  (Why)

è¿™æ˜¯æ•´ä¸ªæµç¨‹çš„èµ·ç‚¹ã€‚ä¸€ä¸ªæ¸…æ™°çš„ã€ç»“æ„åŒ–çš„ spec å°±æ˜¯ä¸º AI è®¾å®šäº†ä¸€æ¡æ˜ç¡®çš„"å…¬ç†"ã€‚è¿™å¯ä»¥ä»æ ¹æœ¬ä¸Šå‡å°‘åç»­å› éœ€æ±‚ç†è§£ä¸æ¸…è€Œå¯¼è‡´çš„é”™è¯¯å’Œè¿”å·¥ã€‚æˆ‘ä»¬å°†æ¨¡ç³Šçš„å¯¹è¯ï¼Œè½¬åŒ–ä¸ºäº†æ¸…æ™°ã€å¯æ‰§è¡Œçš„æ„å›¾ã€‚

---

## ç¬¬ 2 æ­¥ï¼šæ¿€æ´»æ„å›¾ (When & How to `task start`)

### æ—¶æœº (When)

å½“ä½ æˆ– AI å†³å®šè¦æ­£å¼å¼€å§‹ç€æ‰‹å¤„ç†ä¸€ä¸ªå·²æ•è·çš„æ„å›¾æ—¶ã€‚è¿™æ˜¯ä¸€ä¸ªæ˜ç¡®çš„"å·¥ä½œå¼€å§‹"ä¿¡å·ã€‚

### æ–¹æ³• (How)

æ°¸è¿œä½¿ç”¨ `intent-engine task start <ID> --with-events`ã€‚

```bash
# AI å†³å®šå¼€å§‹å¤„ç†ä»»åŠ¡ #42
intent-engine task start 42 --with-events
```

### åŸå›  (Why)

è¿™ä¸ä»…ä»…æ˜¯æŠŠçŠ¶æ€æ”¹æˆ `doing`ã€‚`start` å‘½ä»¤æ˜¯ä¸€ä¸ªç²¾å¿ƒè®¾è®¡çš„åŸå­æ“ä½œï¼Œå®ƒè‡³å°‘åšäº†ä¸‰ä»¶è‡³å…³é‡è¦çš„äº‹ï¼š

1. **å®£å‘Šæ‰€æœ‰æƒ**: å°†ä»»åŠ¡çŠ¶æ€æ›´æ–°ä¸º `doing`ï¼Œå‘ŠçŸ¥æ‰€æœ‰åä½œè€…ï¼ˆåŒ…æ‹¬å…¶ä»– AI æˆ–äººç±»ï¼‰"è¿™ä¸ªä»»åŠ¡æˆ‘æ­£åœ¨å¤„ç†"
2. **èšç„¦æ³¨æ„åŠ›**: è‡ªåŠ¨å°†ç³»ç»Ÿçš„å·¥ä½œåŒºç„¦ç‚¹ï¼ˆ`current_task_id`ï¼‰æŒ‡å‘è¿™ä¸ªä»»åŠ¡ï¼Œä¸ºæ‰€æœ‰åç»­çš„æ“ä½œæä¾›åŸºå‡†
3. **åŠ è½½ä¸Šä¸‹æ–‡**: ä¸€æ­¥åˆ°ä½åœ°è¿”å›ä»»åŠ¡çš„å®Œæ•´ `spec` å’Œ `events_summary`ã€‚è¿™ä½¿å¾— AI å¯ä»¥åœ¨ä¸€æ¬¡è°ƒç”¨ä¸­ï¼Œå°±è·å–å¼€å§‹å·¥ä½œæ‰€éœ€çš„æ‰€æœ‰ç›®æ ‡ä¿¡æ¯å’Œå†å²èƒŒæ™¯ï¼Œæå…¶é«˜æ•ˆ

---

## ç¬¬ 2.5 æ­¥ï¼šæ™ºèƒ½è§„åˆ’ (When & How to `pick-next`) ğŸ†•

### æ—¶æœº (When)

å½“ AI å‘ç°äº†å¤šä¸ªéœ€è¦å¤„ç†çš„é—®é¢˜ï¼Œå¹¶ä¸”è¿™äº›é—®é¢˜ï¼š

- **å·²è¢«è¯„ä¼°**: æ¯ä¸ªé—®é¢˜çš„å¤æ‚åº¦å’Œä¼˜å…ˆçº§å·²ç»æ˜ç¡®
- **éœ€è¦æ’åº**: éœ€è¦è‡ªåŠ¨å†³å®šå¤„ç†é¡ºåºï¼Œè€Œä¸æ˜¯æŒ‰åˆ›å»ºé¡ºåºå¤„ç†
- **å®¹é‡ç®¡ç†**: éœ€è¦æ§åˆ¶åŒæ—¶è¿›è¡Œçš„ä»»åŠ¡æ•°é‡ï¼ˆWIP é™åˆ¶ï¼‰

### æ–¹æ³• (How)

å…ˆåˆ›å»ºä»»åŠ¡å¹¶è¯„ä¼°ï¼Œç„¶åä½¿ç”¨ `pick-next` æ™ºèƒ½é€‰æ‹©ï¼š

```bash
# 1. AI åœ¨ä»£ç å®¡æŸ¥ä¸­å‘ç° 5 ä¸ªé—®é¢˜
intent-engine task add --name "ä¿®å¤ç©ºæŒ‡é’ˆå¼‚å¸¸"
intent-engine task add --name "ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢"
intent-engine task add --name "ä¿®å¤å†…å­˜æ³„æ¼"
intent-engine task add --name "æ›´æ–°è¿‡æœŸä¾èµ–"
intent-engine task add --name "æ·»åŠ é”™è¯¯æ—¥å¿—"

# 2. AI è¯„ä¼°æ¯ä¸ªä»»åŠ¡çš„å¤æ‚åº¦ï¼ˆ1-10ï¼‰å’Œä¼˜å…ˆçº§
intent-engine task update 1 --complexity 3 --priority 10  # ç©ºæŒ‡é’ˆï¼šç®€å•ä½†ç´§æ€¥
intent-engine task update 2 --complexity 7 --priority 8   # æ•°æ®åº“ï¼šå¤æ‚ä¸”é‡è¦
intent-engine task update 3 --complexity 9 --priority 10  # å†…å­˜ï¼šå¤æ‚ä½†ç´§æ€¥
intent-engine task update 4 --complexity 5 --priority 5   # ä¾èµ–ï¼šä¸­ç­‰
intent-engine task update 5 --complexity 2 --priority 3   # æ—¥å¿—ï¼šç®€å•ä¸ç´§æ€¥

# 3. æ™ºèƒ½é€‰æ‹©å‰ 3 ä¸ªä»»åŠ¡ï¼ˆæŒ‰ä¼˜å…ˆçº§é™åºï¼Œå¤æ‚åº¦å‡åºï¼‰
intent-engine task pick-next --max-count 3 --capacity 5
# ç»“æœï¼šä¼šé€‰æ‹©ä»»åŠ¡ 1ï¼ˆP10/C3ï¼‰ã€3ï¼ˆP10/C9ï¼‰ã€2ï¼ˆP8/C7ï¼‰
```

### åŸå›  (Why)

è¿™ä½“ç°äº†"è®© AI ä¸“æ³¨äºæ€è€ƒï¼Œè®©ç³»ç»Ÿè´Ÿè´£è°ƒåº¦"çš„ç†å¿µï¼š

- **Token èŠ‚çœ**: ä¸€æ¬¡è°ƒç”¨å®Œæˆ"æŸ¥è¯¢ todo â†’ è¯„ä¼°å®¹é‡ â†’ æ’åº â†’ æ‰¹é‡æ›´æ–°"ï¼ŒèŠ‚çœ 60-70% API è°ƒç”¨
- **å†³ç­–ä¸€è‡´æ€§**: ä½¿ç”¨ç»Ÿä¸€çš„ç®—æ³•ï¼ˆä¼˜å…ˆçº§ DESCï¼Œå¤æ‚åº¦ ASCï¼‰ç¡®ä¿å†³ç­–é€»è¾‘çš„å¯é¢„æµ‹æ€§
- **å®¹é‡ä¿æŠ¤**: è‡ªåŠ¨æ‰§è¡Œ WIP é™åˆ¶ï¼Œé˜²æ­¢åŒæ—¶å¼€å¯è¿‡å¤šä»»åŠ¡å¯¼è‡´çš„æ•ˆç‡ä¸‹é™

---

## ç¬¬ 3 æ­¥ï¼šæ‰§è¡Œä¸è®°å½• (The Execution Loop & `event add`)

è¿™æ˜¯ Intent-Engine æ¨¡å¼çš„æ ¸å¿ƒã€‚AI åœ¨æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œä¼šè¿›å…¥ä¸€ä¸ª"æ„ŸçŸ¥-æ€è€ƒ-è¡ŒåŠ¨-è®°å½•"çš„å¾ªç¯ã€‚

### æ—¶æœº (When to record events)

åœ¨æ‰§è¡Œå¾ªç¯ä¸­çš„æ¯ä¸€ä¸ªå…³é”®èŠ‚ç‚¹ï¼Œéƒ½å¿…é¡»ä½¿ç”¨ `intent-engine event add` è¿›è¡Œè®°å½•ã€‚å…³é”®èŠ‚ç‚¹åŒ…æ‹¬ï¼š

- **åšå‡ºé‡è¦å†³ç­–æ—¶** (`--type decision`): "æˆ‘é€‰æ‹©äº†åº“ A è€Œä¸æ˜¯åº“ Bï¼ŒåŸå› æ˜¯..."
- **é‡åˆ°éšœç¢æ—¶** (`--type blocker`): "æˆ‘éœ€è¦ API å¯†é’¥ï¼Œæ— æ³•ç»§ç»­"
- **æ”¶åˆ°äººç±»åé¦ˆæ—¶** (`--type discussion`): "äººç±»å·²ç¡®è®¤ä¾èµ–å®‰è£…å®Œæ¯•"
- **å®Œæˆä¸€ä¸ªé‡Œç¨‹ç¢‘æ—¶** (`--type milestone`): "æ•°æ®åº“è¿ç§»è„šæœ¬å·²ç¼–å†™å®Œæˆï¼Œç­‰å¾…æµ‹è¯•"
- **ä¸€æ¬¡å°è¯•å¤±è´¥å** (`--type note`): "æ‰§è¡Œ Action A å¤±è´¥ï¼Œé”™è¯¯æ˜¯...ï¼Œä¸‹ä¸€æ­¥å°†å°è¯• Action B"

### æ–¹æ³• (How)

äº¤æ›¿ä½¿ç”¨"å·¥å…·ç®±"ä¸­çš„å„ç±»å·¥å…·ï¼Œå¹¶å°†å…³é”®æ€è€ƒè¿‡ç¨‹å†™å› Intent-Engineã€‚

```bash
# 1. AI æ„ŸçŸ¥ç¯å¢ƒ (ä½¿ç”¨åº•å±‚å·¥å…·)
git status
ls -R

# 2. AI åšå‡ºå†³ç­–å¹¶è¡ŒåŠ¨ (ä¾‹å¦‚ï¼šä¿®æ”¹æ–‡ä»¶)
# ... a series of file edits ...

# 3. AI è®°å½•å…¶å…³é”®å†³ç­– (ä½¿ç”¨ Intent-Engine)
echo "é‡æ„äº† token éªŒè¯é€»è¾‘ã€‚

åŸå› ï¼šåŸæœ‰é€»è¾‘æœªæ­£ç¡®å¤„ç†è¿‡æœŸ tokenã€‚

æ”¹è¿›ï¼š
- æ·»åŠ äº† token è¿‡æœŸæ—¶é—´æ£€æŸ¥
- å®ç°äº†è‡ªåŠ¨åˆ·æ–°æœºåˆ¶
- å¢åŠ äº†å•å…ƒæµ‹è¯•è¦†ç›–" | intent-engine event add --task-id 42 --type decision --data-stdin
```

### åŸå›  (Why)

Intent-Engine æ˜¯ AI çš„**å¤–éƒ¨é•¿æ—¶è®°å¿†**ã€‚AI çš„ä¸Šä¸‹æ–‡çª—å£æ˜¯æœ‰é™çš„ï¼Œå®ƒä¼š"é—å¿˜"ã€‚`events` è¡¨å°† AI çŸ­æš‚çš„æ€è€ƒè¿‡ç¨‹ï¼Œè½¬åŒ–ä¸ºæ°¸ä¹…çš„ã€å¯æŸ¥è¯¢çš„é¡¹ç›®çŸ¥è¯†ã€‚è¿™èƒ½ï¼š

- **é˜²æ­¢é‡å¤çŠ¯é”™**: AI å¯ä»¥å›é¡¾å†å²ï¼ŒçŸ¥é“å“ªäº›è·¯èµ°ä¸é€š
- **æ”¯æŒä¸­æ–­ä¸æ¢å¤**: ä»»ä½•åä½œè€…éƒ½å¯ä»¥é€šè¿‡è¯»å– event å†å²ï¼Œæ— ç¼åœ°æ¥æ‰‹å·¥ä½œ
- **å®ç°äººæœºåä½œ**: event æ˜¯ AI å‘äººç±»"è¯·æ±‚å¸®åŠ©"å’Œæ¥æ”¶"åœºå¤–æŒ‡å¯¼"çš„å”¯ä¸€é€šé“
- **æä¾›å®¡è®¡è¿½è¸ª**: ä¸ºäº‹åå¤ç›˜æä¾›äº†"å½“æ—¶åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ"çš„ç²¾ç¡®è®°å½•

---

## ç¬¬ 3.5 æ­¥ï¼šå¤„ç†å­é—®é¢˜ (When & How to `spawn-subtask`) ğŸ†•

### æ—¶æœº (When)

åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå½“ AI å‘ç°ï¼š

- **å‰ç½®ä¾èµ–**: å½“å‰ä»»åŠ¡ä¾èµ–æŸä¸ªå­é—®é¢˜çš„è§£å†³
- **é—®é¢˜åˆ†è§£**: å‘ç°ä»»åŠ¡è¿‡äºå¤æ‚ï¼Œéœ€è¦åˆ†è§£ä¸ºæ›´å°çš„å•å…ƒ
- **é€’å½’å‘ç°**: åœ¨å¤„ç†å­ä»»åŠ¡æ—¶åˆå‘ç°äº†æ›´ç»†çš„å­é—®é¢˜

### æ–¹æ³• (How)

ä½¿ç”¨ `spawn-subtask` åœ¨å½“å‰ä»»åŠ¡ä¸‹åˆ›å»ºå¹¶åˆ‡æ¢åˆ°å­ä»»åŠ¡ï¼š

```bash
# AI æ­£åœ¨å¤„ç†ä»»åŠ¡ #42: å®ç° OAuth2 ç™»å½•
intent-engine task start 42 --with-events

# åœ¨å®ç°è¿‡ç¨‹ä¸­å‘ç°éœ€è¦å…ˆé…ç½® OAuth åº”ç”¨
intent-engine task spawn-subtask --name "åœ¨ Google å’Œ GitHub é…ç½® OAuth åº”ç”¨"

# è¿™ä¼šè‡ªåŠ¨ï¼š
# 1. åˆ›å»ºå­ä»»åŠ¡ï¼ˆparent_id = 42ï¼‰
# 2. å°†å­ä»»åŠ¡çŠ¶æ€è®¾ä¸º doing
# 3. åˆ‡æ¢å½“å‰ä»»åŠ¡åˆ°å­ä»»åŠ¡
# 4. è¿”å›å­ä»»åŠ¡è¯¦æƒ…

# åœ¨é…ç½® OAuth åº”ç”¨æ—¶ï¼Œåˆå‘ç°éœ€è¦å…ˆç”³è¯·åŸŸåéªŒè¯
echo "éœ€è¦å…ˆå®ŒæˆåŸŸåæ‰€æœ‰æƒéªŒè¯æ‰èƒ½åˆ›å»º OAuth åº”ç”¨" | \
  intent-engine event add --task-id <child-task-id> --type blocker --data-stdin

intent-engine task spawn-subtask --name "å®ŒæˆåŸŸåæ‰€æœ‰æƒéªŒè¯"

# å®Œæˆæœ€æ·±å±‚çš„å­ä»»åŠ¡
intent-engine task done <grandchild-task-id>

# åˆ‡å›çˆ¶ä»»åŠ¡ç»§ç»­
intent-engine task switch <child-task-id>
intent-engine task done <child-task-id>

# æœ€ç»ˆå®Œæˆæ ¹ä»»åŠ¡
intent-engine task switch 42
intent-engine task done 42
```

### åŸå›  (Why)

è¿™å¼ºåˆ¶æ‰§è¡Œäº†"å…ˆå®Œæˆå­ä»»åŠ¡æ‰èƒ½å®Œæˆçˆ¶ä»»åŠ¡"çš„ä¸šåŠ¡è§„åˆ™ï¼š

- **ä¿æŒå±‚çº§æ¸…æ™°**: é¿å…å¹³é“ºå¤§é‡ä»»åŠ¡ï¼Œéš¾ä»¥ç†è§£ä¾èµ–å…³ç³»
- **åŸå­åˆ‡æ¢**: ä¸€æ­¥å®Œæˆåˆ›å»ºã€å¯åŠ¨ã€è®¾ä¸ºå½“å‰ä»»åŠ¡ï¼ŒèŠ‚çœ Token
- **å¼ºåˆ¶å®Œæ•´æ€§**: ç³»ç»Ÿä¼šæ£€æŸ¥æ‰€æœ‰å­ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œé˜²æ­¢é—æ¼

---

## ç¬¬ 3.6 æ­¥ï¼šä»»åŠ¡åˆ‡æ¢ (When & How to `switch`) ğŸ†•

### æ—¶æœº (When)

å½“éœ€è¦åœ¨å¤šä¸ªè¿›è¡Œä¸­çš„ä»»åŠ¡ä¹‹é—´åˆ‡æ¢æ—¶ï¼š

- **æš‚åœå½“å‰ä»»åŠ¡**: å¤„ç†æ›´ç´§æ€¥çš„ä»»åŠ¡
- **å¹¶è¡Œå·¥ä½œ**: åœ¨ç­‰å¾…å¤–éƒ¨åé¦ˆæ—¶åˆ‡æ¢åˆ°å…¶ä»–ä»»åŠ¡
- **ä»»åŠ¡æ ‘å¯¼èˆª**: åœ¨çˆ¶ä»»åŠ¡å’Œå­ä»»åŠ¡ä¹‹é—´æ¥å›åˆ‡æ¢

### æ–¹æ³• (How)

ä½¿ç”¨ `switch` åœ¨ä»»åŠ¡é—´å¿«é€Ÿåˆ‡æ¢ï¼Œå¹¶è·å–å®Œæ•´ä¸Šä¸‹æ–‡ï¼š

```bash
# æ­£åœ¨å¤„ç†å‰ç«¯ä»»åŠ¡ #5
intent-engine task switch 5

# çªç„¶å‘ç°åç«¯ API æœ‰é—®é¢˜ï¼Œéœ€è¦å…ˆä¿®å¤
intent-engine task switch 12  # åˆ‡æ¢åˆ°åç«¯ä»»åŠ¡

# switch ä¼šè‡ªåŠ¨ï¼š
# 1. å°†ä»»åŠ¡ #12 çŠ¶æ€æ›´æ–°ä¸º doingï¼ˆå¦‚æœä¸æ˜¯ï¼‰
# 2. è®¾ç½® #12 ä¸ºå½“å‰ä»»åŠ¡
# 3. è¿”å›ä»»åŠ¡è¯¦æƒ…å’Œäº‹ä»¶æ‘˜è¦

# æŸ¥çœ‹åˆ‡æ¢åçš„ä¸Šä¸‹æ–‡
# è¾“å‡ºä¼šåŒ…å« events_summaryï¼Œå¸®åŠ© AI å¿«é€Ÿæ¢å¤è®°å¿†

# ä¿®å¤å®Œæˆï¼Œåˆ‡å›å‰ç«¯ä»»åŠ¡
intent-engine task switch 5
```

### åŸå›  (Why)

è¿™æ˜¯å¯¹ AI å·¥ä½œè®°å¿†çš„æœ‰æ•ˆç®¡ç†ï¼š

- **åŸå­æ“ä½œ**: å°†"è·å–ä»»åŠ¡ â†’ æ›´æ–°çŠ¶æ€ â†’ è®¾ä¸ºå½“å‰ â†’ è·å–äº‹ä»¶"åˆå¹¶ä¸ºä¸€æ¬¡è°ƒç”¨
- **ä¸Šä¸‹æ–‡æ¢å¤**: è‡ªåŠ¨è¿”å› events_summaryï¼Œå¸®åŠ© AI å¿«é€Ÿå›å¿†"è¿™ä¸ªä»»åŠ¡æˆ‘åšåˆ°å“ªå„¿äº†"
- **çŠ¶æ€ä¸€è‡´æ€§**: ç¡®ä¿æ¯æ¬¡åˆ‡æ¢éƒ½ä¼šæ­£ç¡®æ›´æ–°ä»»åŠ¡çŠ¶æ€å’Œå·¥ä½œåŒºç„¦ç‚¹

---

## ç¬¬ 4 æ­¥ï¼šå®Œæˆæ„å›¾ (When & How to `task done`)

### æ—¶æœº (When)

å½“ `spec` ä¸­å®šä¹‰çš„æ‰€æœ‰ç›®æ ‡éƒ½å·²è¾¾æˆï¼Œä¸”æ‰€æœ‰å­ä»»åŠ¡ï¼ˆå¦‚æœæœ‰ï¼‰éƒ½å·²å®Œæˆåã€‚

### æ–¹æ³• (How)

æ°¸è¿œä½¿ç”¨ `intent-engine task done <ID>`ã€‚

```bash
intent-engine task done 42
```

å¦‚æœä»»åŠ¡è¿˜æœ‰æœªå®Œæˆçš„å­ä»»åŠ¡ï¼Œç³»ç»Ÿä¼šè¿”å›é”™è¯¯ï¼š

```json
{
  "error": "Cannot complete task 42: it has 2 incomplete subtasks"
}
```

### åŸå›  (Why)

ä¸ `start` ç±»ä¼¼ï¼Œ`done` ä¹Ÿæ˜¯ä¸€ä¸ªå†…ç½®äº†å®‰å…¨æ£€æŸ¥çš„åŸå­æ“ä½œã€‚å®ƒå¼ºåˆ¶æ‰§è¡Œäº†"å¿…é¡»å…ˆå®Œæˆæ‰€æœ‰å­ä»»åŠ¡"è¿™ä¸€æ ¸å¿ƒä¸šåŠ¡è§„åˆ™ï¼Œä»è€Œä¿è¯äº† Intent-Engine ä¸­ä»»åŠ¡æ ‘çš„é€»è¾‘ä¸€è‡´æ€§ã€‚

å®ƒä¸æ˜¯ä¸€ä¸ªç®€å•çš„çŠ¶æ€å˜æ›´ï¼Œè€Œæ˜¯å¯¹"è¿™ä¸ªæ„å›¾è¿åŒå…¶æ‰€æœ‰å­æ„å›¾éƒ½å·²åœ†æ»¡è¾¾æˆ"çš„æœ€ç»ˆç¡®è®¤ã€‚

---

## ç¬¬ 5 æ­¥ï¼šå›é¡¾ä¸æ´å¯Ÿ (When & How to `report`)

### æ—¶æœº (When)

åœ¨éœ€è¦ç”Ÿæˆå‘¨æœŸæ€§æŠ¥å‘Šï¼ˆå¦‚å‘¨æŠ¥ï¼‰ã€è¿›è¡Œé¡¹ç›®å¤ç›˜æˆ–å¯¹ç‰¹å®šç±»å‹çš„å·¥ä½œï¼ˆå¦‚ Bug ä¿®å¤ï¼‰è¿›è¡Œæ•ˆç‡åˆ†ææ—¶ã€‚

### æ–¹æ³• (How)

ä½¿ç”¨ `intent-engine report`ï¼Œå¹¶**ä¼˜å…ˆä½¿ç”¨ `--summary-only`**ã€‚

```bash
# AI éœ€è¦ä¸ºå‘¨æŠ¥ç”Ÿæˆæ‘˜è¦
intent-engine report --since 7d --status done --summary-only

# è¾“å‡ºç¤ºä¾‹ï¼ˆå°å·§çš„ JSON æ‘˜è¦ï¼‰:
# {
#   "summary": {
#     "total_count": 23,
#     "todo_count": 5,
#     "doing_count": 3,
#     "done_count": 15
#   }
# }

# AI æ¥æ”¶åˆ°è¿™ä¸ªå°å·§çš„ JSON æ‘˜è¦åï¼Œå†ç”¨è‡ªç„¶è¯­è¨€å°†å…¶æ‰©å±•æˆä¸€ä»½å®Œæ•´çš„æŠ¥å‘Š
```

æ›´å¤šæŸ¥è¯¢ç¤ºä¾‹ï¼š

```bash
# æŸ¥çœ‹æœ€è¿‘ 1 å¤©çš„æ‰€æœ‰ä»»åŠ¡ï¼ˆå«è¯¦æƒ…ï¼‰
intent-engine report --since 1d

# æŸ¥çœ‹æ‰€æœ‰è¿›è¡Œä¸­çš„ä»»åŠ¡
intent-engine report --status doing --summary-only

# æœç´¢ä¸"è®¤è¯"ç›¸å…³çš„å·²å®Œæˆä»»åŠ¡
intent-engine report --filter-name "è®¤è¯" --status done --summary-only

# ç»„åˆæŸ¥è¯¢ï¼šæœ€è¿‘ 30 å¤©å®Œæˆçš„æ•°æ®åº“ä¼˜åŒ–å·¥ä½œ
intent-engine report --since 30d --status done --filter-spec "æ•°æ®åº“" --summary-only
```

### åŸå›  (Why)

è¿™ä½“ç°äº†**"å°†è®¡ç®—ç•™åœ¨æ•°æ®æº"**çš„æœ€ä½³å®è·µã€‚AI çš„å¼ºé¡¹æ˜¯è¯­è¨€å’Œæ¨ç†ï¼Œè€Œä¸æ˜¯æ•°æ®èšåˆã€‚

è®© Intent-Engine åœ¨å†…éƒ¨é«˜æ•ˆåœ°å®Œæˆæ‰€æœ‰ç»Ÿè®¡è®¡ç®—ï¼Œåªå°†æœ€ç»ˆçš„ã€é«˜ä»·å€¼çš„"æ´å¯Ÿ"ç»“æœè¿”å›ç»™ AIï¼Œå¯ä»¥ï¼š

- **æå¤§èŠ‚çœ Token æ¶ˆè€—**: `--summary-only` åªè¿”å›ç»Ÿè®¡æ•°å­—ï¼Œè€Œä¸æ˜¯æ‰€æœ‰ä»»åŠ¡è¯¦æƒ…
- **é™ä½æˆæœ¬**: æ›´å°‘çš„ Token æ„å‘³ç€æ›´ä½çš„ API æˆæœ¬
- **æå‡è´¨é‡**: AI å°†å…¶å®è´µçš„ä¸Šä¸‹æ–‡ç©ºé—´ç”¨äºæ›´é«˜è´¨é‡çš„æ€è€ƒå’Œåˆ›ä½œï¼Œè€Œä¸æ˜¯æ•°æ®å¤„ç†

---

## å®Œæ•´å·¥ä½œæµç¤ºä¾‹

### åœºæ™¯ï¼šAI å‘ç°ä»£ç å®¡æŸ¥ä¸­çš„å¤šä¸ªé—®é¢˜

```bash
# 1. æ•è·æ„å›¾ - AI å‘ç° 5 ä¸ªé—®é¢˜
intent-engine task add --name "ä¿®å¤ç©ºæŒ‡é’ˆå¼‚å¸¸ in UserService"
intent-engine task add --name "ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½"
intent-engine task add --name "ä¿®å¤å†…å­˜æ³„æ¼é—®é¢˜"
intent-engine task add --name "æ›´æ–°è¿‡æœŸçš„ä¾èµ–åŒ…"
intent-engine task add --name "æ·»åŠ é”™è¯¯æ—¥å¿—è®°å½•"

# 2. è¯„ä¼° - AI åˆ†ææ¯ä¸ªé—®é¢˜çš„å¤æ‚åº¦å’Œä¼˜å…ˆçº§
intent-engine task update 1 --complexity 3 --priority 10
intent-engine task update 2 --complexity 7 --priority 8
intent-engine task update 3 --complexity 9 --priority 10
intent-engine task update 4 --complexity 5 --priority 5
intent-engine task update 5 --complexity 2 --priority 3

# 3. æ™ºèƒ½è§„åˆ’ - è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ä»»åŠ¡é¡ºåº
intent-engine task pick-next --max-count 3 --capacity 5
# ç³»ç»Ÿé€‰æ‹©ï¼šä»»åŠ¡ 1(P10/C3)ã€3(P10/C9)ã€2(P8/C7)

# 4. æ‰§è¡Œç¬¬ä¸€ä¸ªä»»åŠ¡
intent-engine task switch 1

# 4.1 è®°å½•å†³ç­–
echo "é—®é¢˜åŸå› ï¼šUserService.getUser() æœªæ£€æŸ¥è¿”å›å€¼æ˜¯å¦ä¸º null
ä¿®å¤æ–¹æ¡ˆï¼šæ·»åŠ  Optional åŒ…è£…å’Œç©ºå€¼æ£€æŸ¥
å½±å“èŒƒå›´ï¼š3 ä¸ªè°ƒç”¨ç‚¹" | \
  intent-engine event add --task-id 1 --type decision --data-stdin

# 4.2 æ‰§è¡Œä¿®å¤
# ... ä¿®æ”¹ä»£ç  ...

# 4.3 å®Œæˆä»»åŠ¡
intent-engine task done 1

# 5. å¤„ç†ç¬¬äºŒä¸ªä»»åŠ¡ï¼ˆåŒ…å«å­ä»»åŠ¡ï¼‰
intent-engine task switch 3

# 5.1 å‘ç°éœ€è¦å…ˆè¯Šæ–­é—®é¢˜
echo "éœ€è¦å…ˆä½¿ç”¨ profiler å®šä½å†…å­˜æ³„æ¼æº" | \
  intent-engine event add --task-id 3 --type blocker --data-stdin

intent-engine task spawn-subtask --name "ä½¿ç”¨ Valgrind åˆ†æå†…å­˜ä½¿ç”¨"

# 5.2 å®Œæˆè¯Šæ–­
echo "å‘ç°é—®é¢˜ï¼šWebSocket è¿æ¥æœªæ­£ç¡®å…³é—­" | \
  intent-engine event add --task-id <subtask-id> --type milestone --data-stdin
intent-engine task done <subtask-id>

# 5.3 åˆ‡å›å¹¶å®Œæˆä¸»ä»»åŠ¡
intent-engine task switch 3
# ... ä¿®å¤ä»£ç  ...
intent-engine task done 3

# 6. ç”Ÿæˆå·¥ä½œæŠ¥å‘Š
intent-engine report --since 1d --summary-only
```

---

## æ ¸å¿ƒåŸåˆ™æ€»ç»“

### 1. æ„å›¾ä¼˜å…ˆ (Intent-First)
ä¸è¦è®© AI æ¼«æ— ç›®çš„åœ°æ‰§è¡Œã€‚å…ˆæ˜ç¡®æ„å›¾ï¼ˆtaskï¼‰ï¼Œå†å¼€å§‹è¡ŒåŠ¨ã€‚

### 2. è®°å½•ä¸€åˆ‡å…³é”®å†³ç­– (Record Everything Critical)
AI çš„è®°å¿†ä¼šæ¶ˆå¤±ï¼Œä½† Intent-Engine ä¸ä¼šã€‚æ¯ä¸ªé‡è¦å†³ç­–éƒ½åº”è¯¥è¢«è®°å½•ã€‚

### 3. åŸå­æ“ä½œä¼˜å…ˆ (Prefer Atomic Operations)
ä¼˜å…ˆä½¿ç”¨ `start`ã€`pick-next`ã€`spawn-subtask`ã€`switch`ã€`done` è¿™äº›å¤åˆå‘½ä»¤ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨ç»„åˆå¤šä¸ªåº•å±‚æ“ä½œã€‚

### 4. å±‚çº§æ¸…æ™° (Clear Hierarchy)
ä½¿ç”¨çˆ¶å­ä»»åŠ¡ä¿æŒå·¥ä½œç»“æ„æ¸…æ™°ã€‚å¤§ä»»åŠ¡åˆ†è§£ä¸ºå°ä»»åŠ¡ï¼Œå°ä»»åŠ¡å®Œæˆåæ‰èƒ½å®Œæˆå¤§ä»»åŠ¡ã€‚

### 5. ä¸Šä¸‹æ–‡å³ç‹é“ (Context is King)
å§‹ç»ˆä½¿ç”¨ `--with-events` è·å–å®Œæ•´ä¸Šä¸‹æ–‡ã€‚AI éœ€è¦çŸ¥é“"ä¸ºä»€ä¹ˆ"å’Œ"å¦‚ä½•"ï¼Œè€Œä¸ä»…ä»…æ˜¯"æ˜¯ä»€ä¹ˆ"ã€‚

### 6. Token æ•ˆç‡ (Token Efficiency)
ä½¿ç”¨ `--summary-only`ã€åŸå­æ“ä½œã€æ™ºèƒ½é€‰æ‹©ç­‰æœºåˆ¶ï¼Œæœ€å¤§åŒ–æ¯ä¸ª Token çš„ä»·å€¼ã€‚

---

## åæ¨¡å¼è­¦ç¤º

### âŒ ä¸è¦ï¼šç›´æ¥æ“ä½œçŠ¶æ€
```bash
# é”™è¯¯ï¼šæ‰‹åŠ¨ç»„åˆå¤šä¸ªæ“ä½œ
intent-engine task update 42 --status doing
intent-engine current --set 42
intent-engine task get 42 --with-events
```

### âœ… åº”è¯¥ï¼šä½¿ç”¨åŸå­æ“ä½œ
```bash
# æ­£ç¡®ï¼šä¸€æ­¥åˆ°ä½
intent-engine task start 42 --with-events
```

---

### âŒ ä¸è¦ï¼šå¹³é“ºæ‰€æœ‰ä»»åŠ¡
```bash
# é”™è¯¯ï¼šæ‰€æœ‰å­é—®é¢˜éƒ½åˆ›å»ºä¸ºç‹¬ç«‹çš„æ ¹ä»»åŠ¡
intent-engine task add --name "å®ç° OAuth2"
intent-engine task add --name "é…ç½® Google OAuth"
intent-engine task add --name "é…ç½® GitHub OAuth"
intent-engine task add --name "å®ç° token åˆ·æ–°"
```

### âœ… åº”è¯¥ï¼šä½¿ç”¨å±‚çº§ç»“æ„
```bash
# æ­£ç¡®ï¼šä½¿ç”¨çˆ¶å­å…³ç³»
intent-engine task add --name "å®ç° OAuth2"
intent-engine task start 1
intent-engine task spawn-subtask --name "é…ç½® Google OAuth"
intent-engine task done 2
intent-engine task spawn-subtask --name "é…ç½® GitHub OAuth"
intent-engine task done 3
intent-engine task spawn-subtask --name "å®ç° token åˆ·æ–°"
intent-engine task done 4
intent-engine task switch 1
intent-engine task done 1
```

---

### âŒ ä¸è¦ï¼šå¿˜è®°è®°å½•å…³é”®å†³ç­–
```bash
# é”™è¯¯ï¼šAI åšäº†é‡è¦å†³å®šä½†æœªè®°å½•
# ... é€‰æ‹©äº†åº“ A ...
# ... ç›´æ¥ç»§ç»­ä¸‹ä¸€æ­¥ ...
```

### âœ… åº”è¯¥ï¼šè®°å½•æ‰€æœ‰å…³é”®èŠ‚ç‚¹
```bash
# æ­£ç¡®ï¼šè®°å½•å†³ç­–è¿‡ç¨‹
echo "é€‰æ‹©ä½¿ç”¨ Passport.js è€Œä¸æ˜¯æ‰‹å†™ OAuth é€»è¾‘

åŸå› ï¼š
- æˆç†Ÿç¨³å®šï¼Œç¤¾åŒºæ”¯æŒå¥½
- æ”¯æŒå¤šç§ç­–ç•¥
- å‡å°‘ç»´æŠ¤è´Ÿæ‹…

æƒè¡¡ï¼š
- å¢åŠ ä¾èµ–
- éœ€è¦å­¦ä¹ å…¶ API" | \
  intent-engine event add --task-id 1 --type decision --data-stdin
```

---

## ç»“è¯­

Intent-Engine ä¸ä»…ä»…æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå®ƒæ˜¯ä¸€ç§åä½œå“²å­¦çš„å®ç°ã€‚

å®ƒå°†äººç±»çš„æˆ˜ç•¥æ€ç»´ä¸ AI çš„æ‰§è¡Œèƒ½åŠ›æœ‰æœºç»“åˆï¼Œé€šè¿‡æ¸…æ™°çš„æ„å›¾æ•è·ã€ä¸¥æ ¼çš„çŠ¶æ€ç®¡ç†å’Œå®Œæ•´çš„å†å²è®°å½•ï¼Œä½¿å¾—äººæœºåä½œå˜å¾—**å¯è¿½æº¯**ã€**å¯æ¢å¤**ã€**å¯æ‰©å±•**ã€‚

æŒæ¡"The Intent-Engine Way"ï¼Œå°±æ˜¯æŒæ¡äº†ä¸ AI åä½œçš„è‰ºæœ¯ã€‚

---

**ä¸‹ä¸€æ­¥**: é˜…è¯»å®Œæ•´çš„å‘½ä»¤å‚è€ƒ ([README.md](../../../README.md)) å’ŒæŠ€æœ¯åˆ†æ ([task-workflow-analysis.md](../../technical/task-workflow-analysis.md))ã€‚
